# 版本控管完整指南 V2 (包含衝突處理)

本文件整理了完整的 Git 操作流程，從專案初始化、日常同步到進階的衝突解決。

## 1. 初始設定 (專案剛開始時)

如果您建立了一個新專案，想要開始用 Git 管理並上傳到 GitHub。

```bash
# 1. 初始化 Git
git init

# 2. 建立 .gitignore (忽略不需要的檔案)
# (通常建議直接建立一個 .gitignore 檔案，內容包含 /build, .gradle, /bin 等)

# 3. 連結 GitHub 遠端倉庫
# 請替換為您的倉庫網址
git remote add origin https://github.com/AbauDog/novel-listen.git

# 4. 首次上傳
git add .
git commit -m "專案初始化"
git branch -M main
git push -u origin main
```

---

## 2. 日常開發流程 (單人或順利時)

這是您每天最常使用的標準流程。修改程式碼後，執行以下三步：

### 步驟 A: 加入變更 (Stage)
告訴 Git 哪些檔案要記錄。
```bash
git add .
```

### 步驟 B: 提交版本 (Commit)
將加入的變更存成一個版本，務必寫清楚註解。
```bash
git commit -m "這裡寫下您做了什麼修改 (例如: 修正播放器錯誤)"
```

### 步驟 C: 上傳同步 (Push)
將本機的進度上傳到 GitHub。
```bash
git push origin main
```

---

## 3. 解決衝突流程 (當 Push 失敗時)

當您執行 `git push` 出現錯誤訊息 `[rejected] ... remote contains work that you do not have locally`，表示**雲端上有別人（或是您在別台電腦）上傳了新版本**。

這時與您本機的版本衝突了，請依照以下步驟解決：

### 步驟 A: 拉取並嘗試合併 (Pull)
先將雲端的進度抓下來。如果 Git 發現歷史紀錄不相關（例如兩邊各自建立），需加上 `--allow-unrelated-histories`。

```bash
# 一般情況
git pull origin main

# 如果報錯 "fatal: refusing to merge unrelated histories" (通常發生在第一次同步不同步的倉庫時)
git pull origin main --allow-unrelated-histories
```

### 步驟 B: 處理衝突 (Conflict)
如果 Git 自動合併失敗，會告訴您 `CONFLICT (content): Merge conflict in ...`。
這時請打開 **VS Code**：

1.  找到標示為紅色的檔案（有衝突的檔案）。
2.  檔案內會出現 `<<<<<<< HEAD` (您的程式) 和 `>>>>>>> ...` (雲端的程式)。
3.  **決定如何保留**：
    *   選擇「Accept Current Change」(保留您的)
    *   選擇「Accept Incoming Change」(保留雲端的)
    *   或是手動修剪，將兩者整合。
4.  存檔。

### 步驟 C: 提交合併結果 (Commit Merge)
衝突修好後，告訴 Git 您處理完了。

```bash
# 1. 重新加入處理好的檔案 (重要！)
git add .

# 2. 提交合併
git commit -m "解決同步衝突"
```

### 步驟 D: 再次上傳 (Push)
現在您的版本已經包含了雲端的內容，可以順利上傳了。

```bash
git push origin main
```

---

## 4. 常用檢查指令

```bash
# 查看目前狀態 (哪些檔案被改了？哪些還沒 Commit？)
git status

# 查看歷史紀錄
git log

# 查看遠端連結
git remote -v
```
